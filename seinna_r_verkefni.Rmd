---
title: "Verkefni 2"
author: 
  - name: "Brynjar Mar (bmb23), Kári Einarsson (kae44) og Indriði Már Indriðason (imi2)" 
    title: Developers
date: "`r Sys.Date()`"
output:
  rmdformats::downcute:
    downcute_theme: "chaos"
    code_folding: show
    self_contained: true
    thumbnails: false
    lightbox: true
pkgdown:
  as_is: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, cache = FALSE, warning = F, message = F)
```

```{r}
library(tidyverse)
library(ggplot2)
library(scales)
library(knitr)
library(readr)
library(dplyr)
```
# Hluti 1 - Gagnamöndl (10 %)

## a)
Lesið gagnasafnið inn í R/RStudio með skipuninni hér að neðan og geymið í hlut sem ber upphafsstafi þeirra sem verkefnið vinna (ef Gréta Halldórsdóttir og Sigurður Karl Jónsson eru að vinna saman skulu þau nefna hlutinn gs).

nafn_a_hlut <- read_csv2("https://ahj.hi.is/kaupskra.csv", locale = locale(encoding = "ISO8859-1"))

þar sem þið skiptið nafn_a_hlut út fyrir upphafsstafina (þó skal ekki nota íslenska stafi).
```{r}
bik <- read_csv2("https://ahj.hi.is/kaupskra.csv", locale = locale(encoding = "ISO8859-1"))
```
medaltal taknad med $\mu$

## b)
Notið filter() skipunina til að velja fullbúnar eignir (sjá fullbuid breytuna) sem eru "Fjolbyli" og "Serbyli" og byggja á  samningum sem eru er nothæfir. Yfirskrifið stóra gagnaramman í a) lið með þessum eignum.
```{r}
tegund_inni <- c("Serbyli", "Fjolbyli")
bik <- filter(bik, fullbuid==1, tegund%in%tegund_inni, onothaefur_samningur==0)
```



## c)
Búið til nýja breytu í gagnarammanum ykkar sem inniheldur fermetraverð eignanna, nefnið breytuna fermetraverd.
```{r}
bik <- mutate(bik, fermetraverd=kaupverd/einflm)
```

## d)
Búið til nýja breytu í gagnarammanum ykkar sem inniheldur árið sem eignin var seld, nefnið breytuna ar (t.d. með að nota year() fallið í lubridate pakkanum).
```{r}
bik <- mutate(bik, ar=year(utgdag))
```

## e)
Veljið ykkur þrjú póstnúmer til að vinna með. Það þurfa að vera a.m.k. 200 sérbýli í hverju póstúmeri fyrir sig. Yfirskrifið gagnaramman í b) lið með eignum úr þessum þremur póstnúmerum. Þið skulið nota þennan gagnaramma í verkefninu.
```{r}
pnr <- c(107, 105, 210)
bik <- filter(bik, postnr%in%pnr)
```

## f)
Kannið gerð breytanna í gagnarammanum ykkar og breytið ef þarf.  
```{r}
bik <- mutate(bik, emnr = factor(emnr))
bik <- mutate(bik, postnr = factor(postnr))
```

## g)
Hugsum okkur nú að eignirnar í gagnarammanum ykkar sé þýðið ykkar. Nú ætlum við að taka úrtak úr þýðinu, 200 eignir úr hverju hverfi. Það má gera á eftirfarandi hátt:

```{r}
set.seed(39)
bik %>% 
group_by(postnr) %>%
sample_n(size = 200) -> urtak
```

# Hluti 3 (25 %)

## k) Kannið með viðeigandi tilgátuprófi hvort munur sé á meðalfermetraverði fasteigna eftir því hvort þær séu sérbýli eða fjölbýli. Setjið tilgáturnar fram, tilgreinið gildið á prófstærðinni, p-gildið og hvaða ályktun þið dragið.

```{r}


# Búum til tvö úrtök, eitt fyrir sérbýli og annað fyrir fjölbýli
serbýli <- filter(bik, tegund == "Serbyli")$fermetraverd
fjölbýli <- filter(bik, tegund == "Fjolbyli")$fermetraverd

# Framkvæmum t-prófið
t_test_result <- t.test(serbýli, fjölbýli, alternative = "two.sided", var.equal = TRUE)

# Prentum út niðurstöðurnar
print(t_test_result)

```


Út frá niðurstöðunum úr t-prófinu sem hefur verið framkvæmt getum við sett fram og túlkað tilgáturnar, prófstærðina, p-gildið og dregið ályktanir.

### Tilgáturnar
- **Núlltilgáta (H0):** Það er enginn munur á meðalfermetraverði milli sérbýla og fjölbýla. \(μ_{sérbýli} = μ_{fjölbýli}\)
- **Andstæð tilgáta (H1):** Það er munur á meðalfermetraverði milli sérbýla og fjölbýla. \(μ_{sérbýli} ≠ μ_{fjölbýli}\)

### Gildi á prófstærðinni
Prófstærðin (t-gildið) er **-11.6**. Þetta talar um styrk sambandsins milli hópanna; í þessu tilviki, hversu mikill munur er á meðaltölum hópanna í samanburði við staðalfrávikin.

### P-gildi
P-gildið er **minna en 2.2e-16**, sem er mun minna en algengt markmið fyrir marktækni á 0.05 (5% líkur). Þetta þýðir að líkurnar á að fá þessar eða meira öfgameiri niðurstöður, gefið að núlltilgátan sé rétt, eru mjög lágar.

### 95% Öryggisbil
95% öryggisbil fyrir muninn á meðaltölum er frá **-50.76019** til **-36.08557**. Þetta þýðir að við getum verið 95% viss um að raunverulegur munur á meðalfermetraverði milli sérbýla og fjölbýla liggi innan þessa bils. Athugið að öryggisbilið inniheldur ekki núllið, sem styður við marktækan mun.

### Sample Estimates
Meðaltal fermetraverðs fyrir sérbýli (mean of x) er **374.1030**, og fyrir fjölbýli (mean of y) er **417.5259**.

### Ályktun
Þar sem p-gildið er mjög lágt (minna en 2.2e-16), höfnum við núlltilgátunni og ályktum að marktækur munur sé á meðalfermetraverði milli sérbýla og fjölbýla. Gögnin benda til þess að meðalfermetraverð sé lægra fyrir sérbýli en fyrir fjölbýli, með marktækum mun. T-gildið og öryggisbilið gefa okkur frekari upplýsingar um stærð og átt þessa munar.


## l) Búið til nýja breytu, staerd200, sem gefur til kynna hvort eignir séu stærri eða minni en 200 fermetrar (það skiptir ekki máli í hvorum flokknum 200 fermetra eignir lenda).  Kallið flokkinn með stærri eignunum Stærri og minni eignunum Minni. Ábending: notið ifelse() til að búa til breytuna.



```{r}


# Búum til nýja breytu staerd200 með ifelse()
bik2 <- bik$staerd200 <- ifelse(bik$fermetrar >= 200, "Stærri", "Minni")

# Skoðum fyrstu færslurnar til að sjá breytingarnar
head(bik2)

```







